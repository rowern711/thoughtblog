---
layout: default
title: Archive
---
<section class="archive">
  <h1>Archive</h1>
  <div class="filters">
    <div class="pillars-filter">
      <strong>Pillars:</strong>
      {% assign pillars = "philosophy,theology,history,policy" | split: "," %}
      <a href="{{ site.baseurl }}/archive.html">All</a>
      {% for pillar in pillars %}
      <a href="{{ site.baseurl }}/archive.html?pillar={{ pillar }}">{{ pillar | capitalize }}</a>
      {% endfor %}
    </div>
    <div class="topics-filter">
      <strong>Topics:</strong>
      {% assign topics = site.posts | map: 'topics' | join: ',' | split: ',' | uniq | sort %}
      <a href="{{ site.baseurl }}/archive.html">All</a>
      {% for topic in topics %}
      {% if topic != '' %}
      <a href="{{ site.baseurl }}/archive.html?topic={{ topic | uri_escape }}">{{ topic }}</a>
      {% endif %}
      {% endfor %}
    </div>
  </div>

  <div id="archive-list">
    {% assign sorted_posts = site.posts | sort: 'date' | reverse %}
    {% for post in sorted_posts %}
    <article class="archive-row" data-pillar="{{ post.pillar | downcase }}" data-topics="{{ post.topics | join: ' ' | downcase }}">
      <h2><a href="{{ site.baseurl }}{{ post.url }}">{{ post.title }}</a></h2>
      <p class="archive-meta">{{ post.date | date: "%B %-d, %Y" }} · {{ post.pillar | capitalize }}{% if post.topics and post.topics.size > 0 %} · {{ post.topics | join: ', ' }}{% endif %}</p>
      <p class="archive-excerpt">{{ post.excerpt | strip_html | truncate: 160 }}</p>
    </article>
    {% endfor %}
  </div>
</section>

<script>
  (function() {
    var params = new URLSearchParams(window.location.search);
    var pillar = (params.get('pillar') || '').toLowerCase();
    var topic = (params.get('topic') || '').toLowerCase();
    var rows = document.querySelectorAll('.archive-row');

    rows.forEach(function(row) {
      var rowPillar = row.getAttribute('data-pillar');
      var rowTopics = row.getAttribute('data-topics');
      var pillarMatch = !pillar || rowPillar === pillar;
      var topicMatch = !topic || (rowTopics && rowTopics.split(' ').indexOf(topic) !== -1);
      if (pillarMatch && topicMatch) {
        row.style.display = '';
      } else {
        row.style.display = 'none';
      }
    });
  })();
</script>
